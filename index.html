<!DOCTYPE html>
<html>
<head>
    <title>Forward Frogs</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 20px;
        }
        #seviyeDisplay {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #333;
            user-select: none;
        }
    </style>
</head>
<body>
    <h3>Forward Frogs</h3>
    <div id="seviyeDisplay">Seviye: 1</div>
    <canvas id="canvas" width="850" height="600"></canvas>

    <script>
        const cvs = document.getElementById("canvas");
        const ctx = cvs.getContext("2d");
        const seviyeDisplay = document.getElementById("seviyeDisplay");

        const kurbaga = new Image();
        const cimen = new Image();
        const nehir = new Image();
        const odun = new Image();

        const zipla = new Audio("sounds/frog-quak-sound.mp3");

        kurbaga.src = "imgs/kurbaga.png";
        cimen.src = "imgs/cimen.png";
        nehir.src = "imgs/nehir.png";
        odun.src = "imgs/odun.png";

        const totalImages = 4;
        let imagesLoaded = 0;

        kurbaga.onload = cimen.onload = nehir.onload = odun.onload = () => {
            imagesLoaded++;
            if (imagesLoaded === totalImages) startGame();
        };

        let frogs;
        let gameState;
        let odunlar;
        let odunHizi = 1;
        let oyunBaslamaZamani;
        const oyunBaslamaGecikmesi = 3000;
        const ziplamaAraligi = 1500;
        const ziplamaMesafesi = 30;
        let sonZiplamaZamani;
        let seviye = 1;
        let mesafe=200;//kurbağaların arasındaki mesafe

        function startGame() {
            seviye = 1;
            baslatSeviye(seviye);
        }
        

        function baslatSeviye(seviyeSayisi) {
            frogs = [];
            for (let i = 0; i < seviyeSayisi; i++) {
                frogs.push({ x: 300 + i * mesafe, y: 30 });
            }
            gameState = "playing";
            odunlar = [{ x: 0, y: 270 }];
            odunHizi = 1;
            sonZiplamaZamani = Date.now();
            oyunBaslamaZamani = Date.now();
            seviyeDisplay.textContent = `Seviye: ${seviyeSayisi}`;
            draw();
        }

        function draw() {
            ctx.clearRect(0, 0, 850, 600);
            ctx.drawImage(cimen, 0, 0, 850, 600);
            ctx.drawImage(nehir, 0, 270, 850, 30);

            const simdi = Date.now();

            // Kurbağa eğer odunun üzerindeyse odunla beraber hareket edecek
            for (let frog of frogs) {
                if (isKurbağaOdunÜstünde(frog)) {
                    frog.x += odunHizi;
                }
            }

            for (let i = 0; i < odunlar.length; i++) {
                odunlar[i].x += odunHizi;
                ctx.drawImage(odun, odunlar[i].x, odunlar[i].y, 110, 30);
            }

            for (let frog of frogs) {
                ctx.drawImage(kurbaga, frog.x, frog.y, 30, 30);
            }

            if (simdi - sonZiplamaZamani >= ziplamaAraligi && gameState === "playing") {
                for (let frog of frogs) {
                    if (frog.y === 270) {
                    frog.y += ziplamaMesafesi;
                    } else if (frog.y < 270) {
                        frog.y += ziplamaMesafesi;
                    } else if (frog.y >= 300 && frog.y < 390) {
                        frog.y += ziplamaMesafesi;
                    } else if (frog.y >= 390) {
                        gameState = "nextStage";
                        setTimeout(startNextStage, 2000);
                        return;
                    }
                }
                zipla.play();
                sonZiplamaZamani = simdi;
            }

            let sonOdun = odunlar[odunlar.length - 1];
            if (sonOdun.x >= 210) {
                odunlar.push({ x: 0, y: 270 });
            }

            if ((simdi - oyunBaslamaZamani) > oyunBaslamaGecikmesi && gameState === "playing") {
                for (let frog of frogs) {
                    if (frog.y >= 270 && frog.y < 300 && !isKurbağaOdunÜstünde(frog)) {
                        alert("GAME OVER!!!");
                        location.reload();
                        return;
                    }
                }
            }

            requestAnimationFrame(draw);
        }

        function isKurbağaOdunÜstünde(frog) {
            for (let odun of odunlar) {
                if (
                    frog.x < odun.x + 110 &&
                    frog.x + 30 > odun.x &&
                    frog.y + 30 > odun.y &&
                    frog.y < odun.y + 30
                ) {
                    return true;
                }
            }
            return false;
        }

        function startNextStage() {
            seviye++;
            if (seviye > 3) {
                alert("TEBRİKLER! TÜM SEVİYELERİ GEÇTİNİZ!");
                location.reload();
            } else {
                baslatSeviye(seviye);
            }
        }

        document.addEventListener("keydown", function (e) {
            if (e.code === "Space") {
                odunHizi = 3;
            }
        });

        document.addEventListener("keyup", function (e) {
            if (e.code === "Space") {
                odunHizi = 1;
            }
        });
    </script>
</body>
</html>
